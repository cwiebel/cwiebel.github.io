---
title: "Lehrevaluation des Tutoriums Multivariate Statistik im HWS22-23"
output: 
  flexdashboard::flex_dashboard:
    orientation: rows
    vertical_layout: fill
---

```{r setup, include=FALSE}
library(flexdashboard)
library(tidyverse)
library(plotly)
```

```{r data prep, include=FALSE}

data <- readxl::read_excel("data_mva-tut_2023-03-12_14-11.xlsx")

data <- data[2:length(data$CASE),] # meine Testdaten entfernen
which(rowSums(is.na(data)) > 15) # Fälle mit mehr als 15 NAs
which(data$FINISHED == 0) # Fälle die den Fragebogen nicht beendet haben
data <- data[which(data$FINISHED == 1),] # nicht fertig geführte Interviews entfernen
data_mc <- as.data.frame(data[,8:25]) # datensatz für Multiple Choice Items

## MC Antworten aufbereiten
rm(i)
for(i in 1:ncol(data_mc)){
  data_mc[,i] <- factor((data_mc[,i]), levels = c(1,2,3,4,5,-1))} # alle Variablen in data_mc als Faktoren mit festgelegten Stufen

rm(i)
mc_agg <- data.frame(matrix(NA, nrow = 6, ncol = ncol(data_mc))) # neuer dataframe für zusammengefasstes Format
colnames(mc_agg) <- colnames(data_mc)

for (i in 1:ncol(data_mc)){
  mc_agg[,i] <- as.data.frame(table(data_mc[,i]))$Freq} # mit Table Einträge zählen und zusammenfassen


# Neue Spalten mit Prozent-Daten hinzufügen
m <- as.numeric(ncol(mc_agg)) # m = Platzhalter für Anzahl an Items
mc_agg <- cbind(mc_agg, mc_agg) 
rm(i)
names(mc_agg)[(m+1):ncol(mc_agg)] <- paste(names(mc_agg)[(m+1):ncol(mc_agg)], "p", sep = "_")
for(i in 1:m){
  mc_agg[,(m+i)] <- paste(round((mc_agg[,i]/sum(mc_agg[,i]))*100,1),"%")
}

labels <- c("1 = trifft gar\n   nicht zu", "2", "3", "4", # Faktorstufen benennen
            "5 = trifft\n voll zu", "kann ich nicht\n beurteilen")
mc_agg$labels <- labels


```


Inhalt
================================================================================

Row Item 1 {data-height=200}
-----------------------------------------------------------------------

### 
<p><b> Der Inhalt des Tutoriums war gut strukturiert.  </b></p>
N = `r length(data$MC01_01)` <br>
MW = `r round(mean(data$MC01_01),1)` <br>
SD = `r round(sd(data$MC01_01),1)`

### 
```{r fig_height = 300}
plot_ly(mc_agg, x = ~labels, y = ~MC01_01, type = "bar", text = ~MC01_01_p, textposition = "outside", cliponaxis = "F",
        marker = list(color = c("#C0392B", "coral", "#F4D03F", "#28B463", "#0E6655", "#707B7C"))) %>%
  layout(title = "",
         xaxis = list(title = ""),
         yaxis = list(title = "Anzahl Antworten", range = list(0,max(mc_agg$MC01_03)+8),
                      titlefont = list(size = 12)),
         margin=list(0,0,0,0))
```



Row Item 2 {data-height=200}
-----------------------------------------------------------------------

### 
<p> <b>Der Stoff der Lehrveranstaltung wurde anhand von geeigneten Beispielen anschaulich behandelt.  </b></p>
N = `r length(data$MC01_02)` <br>
MW = `r round(mean(data$MC01_02),1)` <br>
SD = `r round(sd(data$MC01_02),1)`

### 
```{r fig_height = 300}
plot_ly(mc_agg, x = ~labels, y = ~MC01_02, type = "bar", text = ~MC01_02_p, textposition = "outside",
        marker = list(color = c("#C0392B", "coral", "#F4D03F", "#28B463", "#0E6655", "#707B7C"))) %>%
  layout(title = "",
         xaxis = list(title = ""),
         yaxis = list(title = "Anzahl Antworten", range = list(0,max(mc_agg$MC01_03)+16),
                      titlefont = list(size = 12)),
         margin=list(0,0,0,0))
```


Row Item 3 {data-height=200}
-----------------------------------------------------------------------

### 
<p> <b>Die Erklärungen der Tutorin waren verständlich. </b> </p>
N = `r length(data$MC01_03)` <br>
MW = `r round(mean(data$MC01_03),1)` <br>
SD = `r round(sd(data$MC01_03),1)`


### 
```{r fig_height = 300}
plot_ly(mc_agg, x = ~labels, y = ~MC01_03, type = "bar", text = ~MC01_03_p, textposition = "outside",
        marker = list(color = c("#C0392B", "coral", "#F4D03F", "#28B463", "#0E6655", "#707B7C"))) %>%
  layout(title = "",
         xaxis = list(title = ""),
         yaxis = list(title = "Anzahl Antworten", range = list(0,max(mc_agg$MC01_03)+5),
                      titlefont = list(size = 12)),
         margin=list(0,0,0,0))
```


Row Item 4 {data-height=200}
-----------------------------------------------------------------------

### 
<p> <b>Die Tutorin war auf die Veranstaltung gut vorbereitet. </b></p>
N = `r length(data$MC01_04)` <br>
MW = `r round(mean(data$MC01_04),1)` <br>
SD = `r round(sd(data$MC01_04),1)`

### 
```{r fig_height = 300}
plot_ly(mc_agg, x = ~labels, y = ~MC01_04, type = "bar", text = ~MC01_04_p, textposition = "outside",
        marker = list(color = c("#C0392B", "coral", "#F4D03F", "#28B463", "#0E6655", "#707B7C"))) %>%
  layout(title = "",
         xaxis = list(title = ""),
         yaxis = list(title = "Anzahl Antworten", range = list(0,max(mc_agg$MC01_03)+20),
                      titlefont = list(size = 12)),
         margin=list(0,0,0,0))
```


Row Item 5 {data-height=200}
-----------------------------------------------------------------------

### 
<p> <b>Die Bedeutung/der Nutzen der behandelten Themen wurde vermittelt.  </b></p>
N = `r length(data$MC01_05)` <br>
MW = `r round(mean(data$MC01_05),1)` <br>
SD = `r round(sd(data$MC01_05),1)`


### 
```{r fig_height = 300}
plot_ly(mc_agg, x = ~labels, y = ~MC01_05, type = "bar", text = ~MC01_05_p, textposition = "outside",
        marker = list(color = c("#C0392B", "coral", "#F4D03F", "#28B463", "#0E6655", "#707B7C"))) %>%
  layout(title = "",
         xaxis = list(title = ""),
         yaxis = list(title = "Anzahl Antworten", range = list(0,max(mc_agg$MC01_03)+8),
                      titlefont = list(size = 12)),
         margin=list(0,0,0,0))
```


Organisation
================================================================================

Row Item 1 {data-height=200}
-----------------------------------------------------------------------
###
<p> <b>Die Veranstaltung war gut organisiert (z. B. Zeitmanagement, Terminorganisation).  </b></p>
N = `r length(data$MC02_05)` <br>
MW = `r round(mean(data$MC02_05),1)` <br>
SD = `r round(sd(data$MC02_05),1)`

###
```{r fig_height = 300}
plot_ly(mc_agg, x = ~labels, y = ~MC02_05, type = "bar", text = ~MC02_05_p, textposition = "outside",
        marker = list(color = c("#C0392B", "coral", "#F4D03F", "#28B463", "#0E6655", "#707B7C"))) %>%
  layout(title = "",
         xaxis = list(title = ""),
         yaxis = list(title = "Anzahl Antworten", range = list(0,max(mc_agg$MC02_05)+5)),
         margin=list(0,0,0,0))
```



Row Item 2 {data-height=200}
-----------------------------------------------------------------------

### 
<p> <b>Es wurden hilfreiche Materialien (z. B. Skript, Folien, Literatur) zur Verfügung gestellt.  </b></p>
N = `r length(data$MC02_06)` <br>
MW = `r round(mean(data$MC02_06),1)` <br>
SD = `r round(sd(data$MC02_06),1)`

### 
```{r fig_height = 300}
plot_ly(mc_agg, x = ~labels, y = ~MC02_06, type = "bar", text = ~MC02_06_p, textposition = "outside",
        marker = list(color = c("#C0392B", "coral", "#F4D03F", "#28B463", "#0E6655", "#707B7C"))) %>%
  layout(title = "",
         xaxis = list(title = ""),
         yaxis = list(title = "Anzahl Antworten", range = list(0,max(mc_agg$MC02_06)+5)),
         margin=list(0,0,0,0))
```


Row Item 3 {data-height=200}
-----------------------------------------------------------------------

### 
<p> <b>Das hybride Format des Tutoriums war für mich passend. </b> </p>
N = `r length(data$MC02_07)` <br>
MW = `r round(mean(data$MC02_07),1)` <br>
SD = `r round(sd(data$MC02_07),1)`


### 
```{r fig_height = 300}
plot_ly(mc_agg, x = ~labels, y = ~MC02_07, type = "bar", text = ~MC02_07_p, textposition = "outside",
        marker = list(color = c("#C0392B", "coral", "#F4D03F", "#28B463", "#0E6655", "#707B7C"))) %>%
  layout(title = "",
         xaxis = list(title = ""),
         yaxis = list(title = "Anzahl Antworten", range = list(0,max(mc_agg$MC02_07)+5)),
         margin=list(0,0,0,0))
```


Tutorin
================================================================================

Row Item 1 {data-height=200}
-----------------------------------------------------------------------

### 
<p><b> Die Tutorin hat sich den Teilnehmenden gegenüber freundlich und respektvoll verhalten.  </b></p>
N = `r length(data$MC03_01)` <br>
MW = `r round(mean(data$MC03_01),1)` <br>
SD = `r round(sd(data$MC03_01),1)`

### 
```{r fig_height = 300}
plot_ly(mc_agg, x = ~labels, y = ~MC03_01, type = "bar", text = ~MC03_01_p, textposition = "outside",
        marker = list(color = c("#C0392B", "coral", "#F4D03F", "#28B463", "#0E6655", "#707B7C"))) %>%
  layout(title = "",
         xaxis = list(title = ""),
         yaxis = list(title = "Anzahl Antworten", range = list(0,max(mc_agg$MC01_03)+16),
                      titlefont = list(size = 12)),
         margin=list(0,0,0,0))
```



Row Item 2 {data-height=200}
-----------------------------------------------------------------------

### 
<p> <b>Die Tutorin förderte die offene und freie Beteiligung der Studierenden.  </b></p>
N = `r length(data$MC03_02)` <br>
MW = `r round(mean(data$MC03_02),1)` <br>
SD = `r round(sd(data$MC03_02),1)`

### 
```{r fig_height = 300}
plot_ly(mc_agg, x = ~labels, y = ~MC03_02, type = "bar", text = ~MC03_02_p, textposition = "outside",
        marker = list(color = c("#C0392B", "coral", "#F4D03F", "#28B463", "#0E6655", "#707B7C"))) %>%
  layout(title = "",
         xaxis = list(title = ""),
         yaxis = list(title = "Anzahl Antworten", range = list(0,max(mc_agg$MC01_03)+8),
                      titlefont = list(size = 12)),
         margin=list(0,0,0,0))
```


Row Item 3 {data-height=200}
-----------------------------------------------------------------------

### 
<p> <b>Die Tutorin wirkte auf mich motivierend. </b> </p>
N = `r length(data$MC03_03)` <br>
MW = `r round(mean(data$MC03_03),1)` <br>
SD = `r round(sd(data$MC03_03),1)`


### 
```{r fig_height = 300}
plot_ly(mc_agg, x = ~labels, y = ~MC03_03, type = "bar", text = ~MC03_03_p, textposition = "outside",
        marker = list(color = c("#C0392B", "coral", "#F4D03F", "#28B463", "#0E6655", "#707B7C"))) %>%
  layout(title = "",
         xaxis = list(title = ""),
         yaxis = list(title = "Anzahl Antworten", range = list(0,max(mc_agg$MC01_03)+23),
                      titlefont = list(size = 12)),
         margin=list(0,0,0,0))
```


Row Item 4 {data-height=200}
-----------------------------------------------------------------------

### 
<p> <b>Die Tutorin bemühte sich festzustellen, ob die Ausführungen verstanden wurden. </b></p>
N = `r length(data$MC03_04)` <br>
MW = `r round(mean(data$MC03_04),1)` <br>
SD = `r round(sd(data$MC03_04),1)`

### 
```{r fig_height = 300}
plot_ly(mc_agg, x = ~labels, y = ~MC03_04, type = "bar", text = ~MC03_04_p, textposition = "outside",
        marker = list(color = c("#C0392B", "coral", "#F4D03F", "#28B463", "#0E6655", "#707B7C"))) %>%
  layout(title = "",
         xaxis = list(title = ""),
         yaxis = list(title = "Anzahl Antworten", range = list(0,max(mc_agg$MC01_03)+16),
                      titlefont = list(size = 12)),
         margin=list(0,0,0,0))
```


Row Item 5 {data-height=200}
-----------------------------------------------------------------------

### 
<p> <b>Die Tutorin hat Gelegenheiten geschaffen, Feedback zur Lehrveranstaltung zu geben. </b></p>
N = `r length(data$MC03_05)` <br>
MW = `r round(mean(data$MC03_05),1)` <br>
SD = `r round(sd(data$MC03_05),1)`


### 
```{r fig_height = 300}
plot_ly(mc_agg, x = ~labels, y = ~MC03_05, type = "bar", text = ~MC03_05_p, textposition = "outside",
        marker = list(color = c("#C0392B", "coral", "#F4D03F", "#28B463", "#0E6655", "#707B7C"))) %>%
  layout(title = "",
         xaxis = list(title = ""),
         yaxis = list(title = "Anzahl Antworten", range = list(0,max(mc_agg$MC01_03)+23),
                      titlefont = list(size = 12)),
         margin=list(0,0,0,0))
```


Gesamt
================================================================================

Row Item 1 {data-height=200}
-----------------------------------------------------------------------

### 
<p><b> Mit der Tutorin bin ich insgesamt zufrieden.  </b></p>
N = `r length(data$MC04_01)` <br>
MW = `r round(mean(data$MC04_01),1)` <br>
SD = `r round(sd(data$MC04_01),1)`

### 
```{r fig_height = 300}
plot_ly(mc_agg, x = ~labels, y = ~MC04_01, type = "bar", text = ~MC04_01_p, textposition = "outside",
        marker = list(color = c("#C0392B", "coral", "#F4D03F", "#28B463", "#0E6655", "#707B7C"))) %>%
  layout(title = "",
         xaxis = list(title = ""),
         yaxis = list(title = "Anzahl Antworten", range = list(0,max(mc_agg$MC04_01)+5)),
         margin=list(0,0,0,0))
```



Row Item 2 {data-height=200}
-----------------------------------------------------------------------

### 
<p> <b>Mit dem Tutorium (Veranstaltung an sich) bin ich insgesamt zufrieden.  </b></p>
N = `r length(data$MC04_02)` <br>
MW = `r round(mean(data$MC04_02),1)` <br>
SD = `r round(sd(data$MC04_02),1)`

### 
```{r fig_height = 300}
plot_ly(mc_agg, x = ~labels, y = ~MC04_02, type = "bar", text = ~MC04_02_p, textposition = "outside",
        marker = list(color = c("#C0392B", "coral", "#F4D03F", "#28B463", "#0E6655", "#707B7C"))) %>%
  layout(title = "",
         xaxis = list(title = ""),
         yaxis = list(title = "Anzahl Antworten", range = list(0,max(mc_agg$MC04_02)+5)),
         margin=list(0,0,0,0))
```


Row Item 3 {data-height=200}
-----------------------------------------------------------------------

### 
<p> <b>Ich habe in diesem Tutorium viel gelernt. </b> </p>
N = `r length(data$MC04_03)` <br>
MW = `r round(mean(data$MC04_03),1)` <br>
SD = `r round(sd(data$MC04_03),1)`


### 
```{r fig_height = 300}
plot_ly(mc_agg, x = ~labels, y = ~MC04_03, type = "bar", text = ~MC04_03_p, textposition = "outside",
        marker = list(color = c("#C0392B", "coral", "#F4D03F", "#28B463", "#0E6655", "#707B7C"))) %>%
  layout(title = "",
         xaxis = list(title = ""),
         yaxis = list(title = "Anzahl Antworten", range = list(0,max(mc_agg$MC04_03)+5)),
         margin=list(0,0,0,0))
```


Row Item 4 {data-height=200}
-----------------------------------------------------------------------

### 
<p> <b>Mein Interesse an den behandelten Inhalten ist durch dieses Tutorium gestiegen. </b></p>
N = `r length(data$MC04_04)` <br>
MW = `r round(mean(data$MC04_04),1)` <br>
SD = `r round(sd(data$MC04_04),1)`

### 
```{r fig_height = 300}
plot_ly(mc_agg, x = ~labels, y = ~MC04_04, type = "bar", text = ~MC04_04_p, textposition = "outside",
        marker = list(color = c("#C0392B", "coral", "#F4D03F", "#28B463", "#0E6655", "#707B7C"))) %>%
  layout(title = "",
         xaxis = list(title = ""),
         yaxis = list(title = "Anzahl Antworten", range = list(0,max(mc_agg$MC04_04)+5)),
         margin=list(0,0,0,0))
```



Offenes Feedback
================================================================================

### Offene Kommentare {data-vertical_layout=scroll}


```{r, code2, results = "asis", echo = FALSE}
feedback <- gsub("[\r\n]", " ", data$OF02_01[-which(is.na(data$OF02_01))])
print(feedback, quote = FALSE)
```







